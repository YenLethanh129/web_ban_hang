<div class="container">
  <div class="info-order-section">
    <div class="page-header">
      <h2>Lịch sử đơn hàng</h2>
      <p class="subtitle">
        Theo dõi tình trạng và chi tiết các đơn hàng tại FUNNY BOY Coffee & Tea
      </p>
    </div>

    <!-- Loading state -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="spinner-border" role="status">
        <span class="sr-only">Đang tải...</span>
      </div>
      <p>Đang tải thông tin đơn hàng...</p>
    </div>

    <!-- Orders list -->
    <div *ngIf="!isLoading && orders.length > 0" class="orders-list">
      <div
        class="order-card"
        *ngFor="let order of orders; trackBy: trackByOrderUuid"
      >
        <div class="order-header">
          <div class="order-info">
            <h4 class="order-uuid">{{ order.order_uuid }}</h4>
            <p class="order-date">
              {{ order.order_date | date : "dd/MM/yyyy HH:mm" }}
            </p>
          </div>
          <div class="order-status">
            <span class="status-badge" [ngClass]="getStatusClass(order.status)">
              {{ getStatusText(order.status) }}
            </span>
          </div>
        </div>

        <div class="order-content">
          <div class="order-summary">
            <div class="summary-item">
              <span class="label">Tổng tiền:</span>
              <span class="value total-amount"
                >{{ order.total_money | number }} VNĐ</span
              >
            </div>

            <div class="summary-item">
              <span class="label">Trạng thái đơn hàng:</span>
              <span class="value" [ngClass]="getStatusClass(order.status)">
                {{ getStatusText(order.status) }}
              </span>
            </div>

            <div class="summary-item">
              <span class="label">Trạng thái thanh toán:</span>
              <span
                class="value"
                [ngClass]="getPaymentStatusClass(order.payment_status)"
              >
                {{ getPaymentStatusText(order.payment_status) }}
              </span>
            </div>

            <div class="summary-item">
              <span class="label">Phương thức thanh toán:</span>
              <span
                class="value"
                [ngClass]="getPaymentMethodClass(order.payment_method)"
              >
                <i [class]="getPaymentMethodIcon(order.payment_method)"></i>
                {{ getPaymentMethodText(order.payment_method) }}
              </span>
            </div>

            <div class="summary-item">
              <span class="label">Số sản phẩm:</span>
              <span class="value">{{ order.order_details.length }} món</span>
            </div>

            <div class="summary-item" *ngIf="order.note">
              <span class="label">Ghi chú:</span>
              <span class="value">{{ order.note }}</span>
            </div>
          </div>

          <div class="order-products">
            <h5>Sản phẩm đã đặt:</h5>
            <div class="product-list">
              <div
                class="product-item"
                *ngFor="let detail of order.order_details"
              >
                <img
                  [src]="detail.product_thumbnail"
                  [alt]="detail.product_name"
                  class="product-image"
                />
                <div class="product-info">
                  <h6 class="product-name">{{ detail.product_name }}</h6>
                  <p class="product-details">
                    Size: {{ detail.size }} | Số lượng: {{ detail.quantity }} |
                    {{ detail.unit_price | number }} VNĐ
                  </p>
                </div>
                <div class="product-total">
                  {{ detail.total_amount | number }} VNĐ
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="order-actions">
          <button class="btn btn-primary" (click)="viewOrderDetails(order)">
            <i class="fas fa-eye"></i>
            Xem chi tiết
          </button>

          <button
            class="btn btn-secondary"
            (click)="editOrder(order)"
            [disabled]="!canCancelOrder(order.status)"
          >
            <i class="fas fa-edit"></i>
            Chỉnh sửa đơn hàng
          </button>
        </div>
      </div>
    </div>

    <!-- Empty state -->
    <div *ngIf="!isLoading && orders.length === 0" class="empty-state">
      <div class="empty-icon">
        <i class="fas fa-shopping-bag"></i>
      </div>
      <h3>Chưa có đơn hàng nào</h3>
      <p>Bạn chưa có đơn hàng nào. Hãy bắt đầu mua sắm ngay!</p>
      <button class="btn btn-primary" [routerLink]="['/']">
        <i class="fas fa-shopping-cart"></i>
        Bắt đầu mua sắm
      </button>
    </div>
  </div>
</div>
